# 機能要件

## 1. 目的
本ドキュメントは、`flutter_recipe_app` の現行実装を基準に、ユーザー向けの機能要件を定義する。

## 2. 対象範囲
- レシピの作成、編集、削除
- 材料量の比例計算
- 調整結果メモの保存
- 保存メモ履歴の参照
- SQLite によるローカル永続化

## 3. 想定ユーザー
- 人数や用途に合わせてレシピ分量を調整したいユーザー

## 4. 機能要件

### FR-01 レシピ一覧
- アプリ起動時に保存済みレシピを一覧表示する。
- 各レシピ行に編集、履歴、削除、計算画面への遷移アクションを提供する。
- レシピが存在しない場合は空状態メッセージを表示する。

### FR-02 レシピ作成
- ユーザーはレシピ名と1件以上の材料でレシピを作成できる。
- 各材料は `name` と `base amount` を持つ。
- 空の材料行は無視する。
- レシピ名が空、または有効な材料が0件の場合は保存を拒否し、メッセージを表示する。

### FR-03 レシピ編集
- ユーザーはレシピ名と材料情報を更新できる。
- 保存時は、材料リストを最新入力内容で置き換える。

### FR-04 レシピ削除
- レシピ削除はユーザーの明示的な確認を必須とする。
- レシピ削除時は、関連する材料、メモ、メモ明細も合わせて削除する。

### FR-05 比例計算
- 計算画面で任意の調整量を編集すると、倍率を再計算する。
- 同一倍率を全材料にリアルタイムで適用する。
- `Reset to base` 操作で倍率を `1.0` に戻す。

### FR-06 調整メモ保存
- ユーザーは現在の計算結果をタイトルとメモ付きで保存できる。
- タイトルが空の場合はデフォルトタイトルを使用する。
- 各メモに保存時刻を記録する。

### FR-07 履歴表示
- メモはレシピ単位で作成日時の降順に表示する。
- 各メモに日時、メモ本文、材料ごとの `base -> adjusted` 値を表示する。

### FR-08 入力値処理
- 分量入力は数値として解析する。
- 小数点区切りとして `.` と `,` の両方を受け付ける。
- 不正な数値入力は計算更新に反映しない。

### FR-09 永続化
- Web 以外ではローカル SQLite ファイルに保存する。
- Web では Web 向け SQLite 実装を使い、初期化失敗時はメモリDBへフォールバックする。

## 5. 対象外
- ユーザー認証
- クラウド同期
- レシピ共有
- 単位換算の自動化
